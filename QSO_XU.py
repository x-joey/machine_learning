D1 = {'AA':0, 'AC':0.112, 'AD':0.819, 'AE':0.827, 'AF':0.54, 'AG':0.208, 'AH':0.696, 'AI':0.407, 'AK':0.891, 'AL':0.406, 'AM':0.379, 'AN':0.318, 'AP':0.191, 'AQ':0.372, 'AR':1, 'AS':0.094, 'AT':0.22, 'AV':0.273, 'AW':0.739, 'AY':0.552,
    'CA':0.114, 'CC':0, 'CD':0.847, 'CE':0.838, 'CF':0.437, 'CG':0.32, 'CH':0.66, 'CI':0.304, 'CK':0.887, 'CL':0.301, 'CM':0.277, 'CN':0.324, 'CP':0.157, 'CQ':0.341, 'CR':1, 'CS':0.176, 'CT':0.233, 'CV':0.167, 'CW':0.639, 'CY':0.457,
    'DA':0.729, 'DC':0.742, 'DD':0, 'DE':0.124, 'DF':0.924, 'DG':0.697, 'DH':0.435, 'DI':0.847, 'DK':0.249, 'DL':0.841, 'DM':0.819, 'DN':0.56, 'DP':0.657, 'DQ':0.584, 'DR':0.295, 'DS':0.667, 'DT':0.649, 'DV':0.797, 'DW':1, 'DY':0.836,
    'EA':0.79,  'EC':0.788, 'ED':0.133, 'EE':0, 'EF':0.932, 'EG':0.779, 'EH':0.406, 'EI':0.860, 'EK':0.143, 'EL':0.854, 'EM':0.83, 'EN':0.599, 'EP':0.688, 'EQ':0.598, 'ER':0.234, 'ES':0.726, 'ET':0.682, 'EV':0.824, 'EW':1, 'EY':0.837,
    'FA':0.508, 'FC':0.405, 'FD':0.977, 'FE':0.918, 'FF':0, 'FG':0.69,  'FH':0.663, 'FI':0.128, 'FK':0.903, 'FL':0.131, 'FM':0.169, 'FN':0.541, 'FP':0.42, 'FQ':0.459, 'FR':1, 'FS':0.548, 'FT':0.499, 'FV':0.252, 'FW':0.207, 'FY':0.179,
    'GA':0.206, 'GC':0.312, 'GD':0.776, 'GE':0.807, 'GF':0.727, 'GG':0, 'GH':0.769, 'GI':0.592, 'GK':0.894, 'GL':0.591, 'GM':0.557, 'GN':0.381, 'GP':0.323, 'GQ':0.467, 'GR':1, 'GS':0.158, 'GT':0.272, 'GV':0.464, 'GW':0.923, 'GY':0.728,
    'HA':0.896, 'HC':0.836, 'HD':0.629, 'HE':0.547, 'HF':0.907, 'HG':1, 'HH':0, 'HI':0.848, 'HK':0.566, 'HL':0.842, 'HM':0.825, 'HN':0.754, 'HP':0.777, 'HQ':0.716, 'HR':0.697, 'HS':0.865, 'HT':0.834, 'HV':0.831, 'HW':0.981, 'HY':0.821,
    'IA':0.403, 'IC':0.296, 'ID':0.942, 'IE':0.891, 'IF':0.134, 'IG':0.592, 'IH':0.652, 'II':0, 'IK':0.892, 'IL':0.013, 'IM':0.057, 'IN':0.457, 'IP':0.311, 'IQ':0.383, 'IR':1, 'IS':0.443, 'IT':0.396, 'IV':0.133, 'IW':0.339, 'IY':0.213,
    'KA':0.889, 'KC':0.871, 'KD':0.279, 'KE':0.149, 'KF':0.957, 'KG':0.9, 'KH':0.438, 'KI':0.899, 'KK':0, 'KL':0.892, 'KM':0.871, 'KN':0.667, 'KP':0.757, 'KQ':0.639, 'KR':0.154, 'KS':0.825, 'KT':0.759, 'KV':0.882, 'KW':1, 'KY':0.848,
    'LA':0.405, 'LC':0.296, 'LD':0.944, 'LE':0.892, 'LF':0.139, 'LG':0.596, 'LH':0.653, 'LI':0.013, 'LK':0.893, 'LL':0, 'LM':0.062, 'LN':0.452, 'LP':0.309, 'LQ':0.376, 'LR':1, 'LS':0.443, 'LT':0.397, 'LV':0.133, 'LW':0.341, 'LY':0.205,
    'MA':0.383, 'MC':0.276, 'MD':0.932, 'ME':0.879, 'MF':0.182, 'MG':0.569, 'MH':0.648, 'MI':0.058, 'MK':0.884, 'ML':0.062, 'MM':0, 'MN':0.447, 'MP':0.285, 'MQ':0.372, 'MR':1, 'MS':0.417, 'MT':0.358, 'MV':0.12, 'MW':0.391, 'MY':0.255,
    'NA':0.424, 'NC':0.425, 'ND':0.838, 'NE':0.835, 'NF':0.766, 'NG':0.512, 'NH':0.78, 'NI':0.615, 'NK':0.891, 'NL':0.603, 'NM':0.588, 'NN':0, 'NP':0.266, 'NQ':0.175, 'NR':1, 'NS':0.361, 'NT':0.368, 'NV':0.503, 'NW':0.945, 'NY':0.641,
    'PA':0.22, 'PC':0.179, 'PD':0.852, 'PE':0.831, 'PF':0.515, 'PG':0.376, 'PH':0.696, 'PI':0.363, 'PK':0.875, 'PL':0.357, 'PM':0.326, 'PN':0.231, 'PP':0, 'PQ':0.288, 'PR':1, 'PS':0.196, 'PT':0.161, 'PV':0.244, 'PW':0.72, 'PY':0.481,
    'QA':0.512, 'QC':0.462, 'QD':0.903, 'QE':0.861, 'QF':0.671, 'QG':0.648, 'QH':0.765, 'QI':0.532, 'QK':0.881, 'QL':0.518, 'QM':0.505, 'QN':0.181, 'QP':0.272, 'QQ':0, 'QR':1, 'QS':0.461, 'QT':0.389, 'QV':0.464, 'QW':0.831, 'QY':0.522,
    'RA':0.919, 'RC':0.905, 'RD':0.305, 'RE':0.225, 'RF':0.977, 'RG':0.928, 'RH':0.498, 'RI':0.929, 'RK':0.141, 'RL':0.92, 'RM':0.908, 'RN':0.69, 'RP':0.796, 'RQ':0.668, 'RR':0, 'RS':0.86, 'RT':0.808, 'RV':0.914, 'RW':1, 'RY':0.859,
    'SA':0.1, 'SC':0.185, 'SD':0.901, 'SE':0.812, 'SF':0.622, 'SG':0.17, 'SH':0.718, 'SI':0.478, 'SK':0.883, 'SL':0.474, 'SM':0.44, 'SN':0.289, 'SP':0.181, 'SQ':0.358, 'SR':1, 'SS':0, 'ST':0.174, 'SV':0.342, 'SW':0.827, 'SY':0.615,
    'TA':0.251, 'TC':0.261, 'TD':0.83, 'TE':0.812, 'TF':0.604, 'TG':0.312, 'TH':0.737, 'TI':0.455, 'TK':0.866, 'TL':0.453, 'TM':0.403, 'TN':0.315, 'TP':0.159, 'TQ':0.322, 'TR':1, 'TS':0.185, 'TT':0, 'TV':0.345, 'TW':0.816, 'TY':0.596,
    'VA':0.275, 'VC':0.165, 'VD':0.9, 'VE':0.867, 'VF':0.269, 'VG':0.471, 'VH':0.649, 'VI':0.135, 'VK':0.889, 'VL':0.134, 'VM':0.12, 'VN':0.38, 'VP':0.212, 'VQ':0.339, 'VR':1, 'VS':0.322, 'VT':0.305, 'VV':0, 'VW':0.472, 'VY':0.31,
    'WA':0.658, 'WC':0.56, 'WD':1, 'WE':0.931, 'WF':0.196, 'WG':0.829, 'WH':0.678, 'WI':0.305, 'WK':0.892, 'WL':0.304, 'WM':0.344, 'WN':0.631, 'WP':0.555, 'WQ':0.538, 'WR':0.968, 'WS':0.689, 'WT':0.638, 'WV':0.418, 'WW':0, 'WY':0.204,
    'YA':0.587, 'YC':0.478, 'YD':1, 'YE':0.932, 'YF':0.202, 'YG':0.782, 'YH':0.678, 'YI':0.230, 'YK':0.904, 'YL':0.219, 'YM':0.268, 'YN':0.512, 'YP':0.444, 'YQ':0.404, 'YR':0.995, 'YS':0.612, 'YT':0.557, 'YV':0.328, 'YW':0.244, 'YY':0}

D2 = {'RS': 0.5116279069767442, 'SR': 0.5116279069767442, 'LS': 0.6744186046511628, 'SL': 0.6744186046511628, 'LR': 0.4744186046511628, 'RL': 0.4744186046511628, 'PS': 0.34418604651162793, 'SP': 0.34418604651162793, 'PR': 0.4790697674418605, 'RP': 0.4790697674418605, 'PL': 0.4558139534883721, 'LP': 0.4558139534883721, 'TS': 0.26976744186046514, 'ST': 0.26976744186046514, 'TR': 0.3302325581395349, 'RT': 0.3302325581395349, 'TL': 0.42790697674418604, 'LT': 0.42790697674418604, 'TP': 0.17674418604651163, 'PT': 0.17674418604651163, 'AS': 0.4604651162790698, 'SA': 0.4604651162790698, 'AR': 0.5209302325581395, 'RA': 0.5209302325581395, 'AL': 0.44651162790697674, 'LA': 0.44651162790697674, 'AP': 0.12558139534883722, 'PA': 0.12558139534883722, 'AT': 0.26976744186046514, 'TA': 0.26976744186046514, 'VS': 0.5767441860465117, 'SV': 0.5767441860465117, 'VR': 0.44651162790697674, 'RV': 0.44651162790697674, 'VL': 0.14883720930232558, 'LV': 0.14883720930232558, 'VP': 0.31627906976744186, 'PV': 0.31627906976744186, 'VT': 0.3209302325581395, 'TV': 0.3209302325581395, 'VA': 0.29767441860465116, 'AV': 0.29767441860465116, 'GS': 0.26046511627906976, 'SG': 0.26046511627906976, 'GR': 0.5813953488372093, 'RG': 0.5813953488372093, 'GL': 0.641860465116279, 'LG': 0.641860465116279, 'GP': 0.19534883720930232, 'PG': 0.19534883720930232, 'GT': 0.2744186046511628, 'TG': 0.2744186046511628, 'GA': 0.27906976744186046, 'AG': 0.27906976744186046, 'GV': 0.5069767441860465, 'VG': 0.5069767441860465, 'IS': 0.6604651162790698, 'SI': 0.6604651162790698, 'IR': 0.4511627906976744, 'RI': 0.4511627906976744, 'IL': 0.023255813953488372, 'LI': 0.023255813953488372, 'IP': 0.4418604651162791, 'PI': 0.4418604651162791, 'IT': 0.413953488372093, 'TI': 0.413953488372093, 'IA': 0.4372093023255814, 'AI': 0.4372093023255814, 'IV': 0.13488372093023257, 'VI': 0.13488372093023257, 'IG': 0.627906976744186, 'GI': 0.627906976744186, 'FS': 0.7209302325581395, 'SF': 0.7209302325581395, 'FR': 0.4511627906976744, 'RF': 0.4511627906976744, 'FL': 0.10232558139534884, 'LF': 0.10232558139534884, 'FP': 0.5302325581395348, 'PF': 0.5302325581395348, 'FT': 0.4790697674418605, 'TF': 0.4790697674418605, 'FA': 0.5255813953488372, 'AF': 0.5255813953488372, 'FV': 0.23255813953488372, 'VF': 0.23255813953488372, 'FG': 0.7116279069767442, 'GF': 0.7116279069767442, 'FI': 0.09767441860465116, 'IF': 0.09767441860465116, 'YS': 0.6697674418604651, 'SY': 0.6697674418604651, 'YR': 0.3581395348837209, 'RY': 0.3581395348837209, 'YL': 0.16744186046511628, 'LY': 0.16744186046511628, 'YP': 0.5116279069767442, 'PY': 0.5116279069767442, 'YT': 0.42790697674418604, 'TY': 0.42790697674418604, 'YA': 0.5209302325581395, 'AY': 0.5209302325581395, 'YV': 0.2558139534883721, 'VY': 0.2558139534883721, 'YG': 0.6837209302325581, 'GY': 0.6837209302325581, 'YI': 0.15348837209302327, 'IY': 0.15348837209302327, 'YF': 0.10232558139534884, 'FY': 0.10232558139534884, 'CS': 0.5209302325581395, 'SC': 0.5209302325581395, 'CR': 0.8372093023255814, 'RC': 0.8372093023255814, 'CL': 0.9209302325581395, 'LC': 0.9209302325581395, 'CP': 0.786046511627907, 'PC': 0.786046511627907, 'CT': 0.6930232558139535, 'TC': 0.6930232558139535, 'CA': 0.9069767441860465, 'AC': 0.9069767441860465, 'CV': 0.8930232558139535, 'VC': 0.8930232558139535, 'CG': 0.7395348837209302, 'GC': 0.7395348837209302, 'CI': 0.9209302325581395, 'IC': 0.9209302325581395, 'CF': 0.9534883720930233, 'FC': 0.9534883720930233, 'CY': 0.9023255813953488, 'YC': 0.9023255813953488, 'HS': 0.413953488372093, 'SH': 0.413953488372093, 'HR': 0.13488372093023257, 'RH': 0.13488372093023257, 'HL': 0.4604651162790698, 'LH': 0.4604651162790698, 'HP': 0.3581395348837209, 'PH': 0.3581395348837209, 'HT': 0.2186046511627907, 'TH': 0.2186046511627907, 'HA': 0.4, 'AH': 0.4, 'HV': 0.39069767441860465, 'VH': 0.39069767441860465, 'HG': 0.4558139534883721, 'GH': 0.4558139534883721, 'HI': 0.4372093023255814, 'IH': 0.4372093023255814, 'HF': 0.46511627906976744, 'FH': 0.46511627906976744, 'HY': 0.386046511627907, 'YH': 0.386046511627907, 'HC': 0.8093023255813954, 'CH': 0.8093023255813954, 'QS': 0.31627906976744186, 'SQ': 0.31627906976744186, 'QR': 0.2, 'RQ': 0.2, 'QL': 0.5255813953488372, 'LQ': 0.5255813953488372, 'QP': 0.35348837209302325, 'PQ': 0.35348837209302325, 'QT': 0.19534883720930232, 'TQ': 0.19534883720930232, 'QA': 0.4232558139534884, 'AQ': 0.4232558139534884, 'QV': 0.44651162790697674, 'VQ': 0.44651162790697674, 'QG': 0.4046511627906977, 'GQ': 0.4046511627906977, 'QI': 0.5069767441860465, 'IQ': 0.5069767441860465, 'QF': 0.5395348837209303, 'FQ': 0.5395348837209303, 'QY': 0.4604651162790698, 'YQ': 0.4604651162790698, 'QC': 0.7162790697674418, 'CQ': 0.7162790697674418, 'QH': 0.11162790697674418, 'HQ': 0.11162790697674418, 'NS': 0.21395348837209302, 'SN': 0.21395348837209302, 'NR': 0.4, 'RN': 0.4, 'NL': 0.7116279069767442, 'LN': 0.7116279069767442, 'NP': 0.4232558139534884, 'PN': 0.4232558139534884, 'NT': 0.3023255813953488, 'TN': 0.3023255813953488, 'NA': 0.5162790697674419, 'AN': 0.5162790697674419, 'NV': 0.6186046511627907, 'VN': 0.6186046511627907, 'NG': 0.37209302325581395, 'GN': 0.37209302325581395, 'NI': 0.6930232558139535, 'IN': 0.6930232558139535, 'NF': 0.7348837209302326, 'FN': 0.7348837209302326, 'NY': 0.6651162790697674, 'YN': 0.6651162790697674, 'NC': 0.6465116279069767, 'CN': 0.6465116279069767, 'NH': 0.31627906976744186, 'HN': 0.31627906976744186, 'NQ': 0.21395348837209302, 'QN': 0.21395348837209302, 'KS': 0.5627906976744186, 'SK': 0.5627906976744186, 'KR': 0.12093023255813953, 'RK': 0.12093023255813953, 'KL': 0.49767441860465117, 'LK': 0.49767441860465117, 'KP': 0.4790697674418605, 'PK': 0.4790697674418605, 'KT': 0.3627906976744186, 'TK': 0.3627906976744186, 'KA': 0.4930232558139535, 'AK': 0.4930232558139535, 'KV': 0.4511627906976744, 'VK': 0.4511627906976744, 'KG': 0.5906976744186047, 'GK': 0.5906976744186047, 'KI': 0.4744186046511628, 'IK': 0.4744186046511628, 'KF': 0.4744186046511628, 'FK': 0.4744186046511628, 'KY': 0.3953488372093023, 'YK': 0.3953488372093023, 'KC': 0.9395348837209302, 'CK': 0.9395348837209302, 'KH': 0.14883720930232558, 'HK': 0.14883720930232558, 'KQ': 0.24651162790697675, 'QK': 0.24651162790697675, 'KN': 0.4372093023255814, 'NK': 0.4372093023255814, 'DS': 0.3023255813953488, 'SD': 0.3023255813953488, 'DR': 0.44651162790697674, 'RD': 0.44651162790697674, 'DL': 0.8, 'LD': 0.8, 'DP': 0.5023255813953489, 'PD': 0.5023255813953489, 'DT': 0.3953488372093023, 'TD': 0.3953488372093023, 'DA': 0.586046511627907, 'AD': 0.586046511627907, 'DV': 0.7069767441860465, 'VD': 0.7069767441860465, 'DG': 0.4372093023255814, 'GD': 0.4372093023255814, 'DI': 0.7813953488372093, 'ID': 0.7813953488372093, 'DF': 0.8232558139534883, 'FD': 0.8232558139534883, 'DY': 0.7441860465116279, 'YD': 0.7441860465116279, 'DC': 0.7162790697674418, 'CD': 0.7162790697674418, 'DH': 0.3767441860465116, 'HD': 0.3767441860465116, 'DQ': 0.2837209302325581, 'QD': 0.2837209302325581, 'DN': 0.10697674418604651, 'ND': 0.10697674418604651, 'DK': 0.4697674418604651, 'KD': 0.4697674418604651, 'ES': 0.37209302325581395, 'SE': 0.37209302325581395, 'ER': 0.25116279069767444, 'RE': 0.25116279069767444, 'EL': 0.641860465116279, 'LE': 0.641860465116279, 'EP': 0.4325581395348837, 'PE': 0.4325581395348837, 'ET': 0.3023255813953488, 'TE': 0.3023255813953488, 'EA': 0.49767441860465117, 'AE': 0.49767441860465117, 'EV': 0.5627906976744186, 'VE': 0.5627906976744186, 'EG': 0.4558139534883721, 'GE': 0.4558139534883721, 'EI': 0.6232558139534884, 'IE': 0.6232558139534884, 'EF': 0.6511627906976745, 'FE': 0.6511627906976745, 'EY': 0.5674418604651162, 'YE': 0.5674418604651162, 'EC': 0.7906976744186046, 'CE': 0.7906976744186046, 'EH': 0.18604651162790697, 'HE': 0.18604651162790697, 'EQ': 0.13488372093023257, 'QE': 0.13488372093023257, 'EN': 0.19534883720930232, 'NE': 0.19534883720930232, 'EK': 0.26046511627906976, 'KE': 0.26046511627906976, 'ED': 0.20930232558139536, 'DE': 0.20930232558139536, 'MS': 0.627906976744186, 'SM': 0.627906976744186, 'MR': 0.4232558139534884, 'RM': 0.4232558139534884, 'ML': 0.06976744186046512, 'LM': 0.06976744186046512, 'MP': 0.4046511627906977, 'PM': 0.4046511627906977, 'MT': 0.3767441860465116, 'TM': 0.3767441860465116, 'MA': 0.39069767441860465, 'AM': 0.39069767441860465, 'MV': 0.09767441860465116, 'VM': 0.09767441860465116, 'MG': 0.5906976744186047, 'GM': 0.5906976744186047, 'MI': 0.046511627906976744, 'IM': 0.046511627906976744, 'MF': 0.13023255813953488, 'FM': 0.13023255813953488, 'MY': 0.16744186046511628, 'YM': 0.16744186046511628, 'MC': 0.9116279069767442, 'CM': 0.9116279069767442, 'MH': 0.4046511627906977, 'HM': 0.4046511627906977, 'MQ': 0.4697674418604651, 'QM': 0.4697674418604651, 'MN': 0.6604651162790698, 'NM': 0.6604651162790698, 'MK': 0.4418604651162791, 'KM': 0.4418604651162791, 'MD': 0.7441860465116279, 'DM': 0.7441860465116279, 'ME': 0.586046511627907, 'EM': 0.586046511627907, 'WS': 0.8232558139534883, 'SW': 0.8232558139534883, 'WR': 0.4697674418604651, 'RW': 0.4697674418604651, 'WL': 0.2837209302325581, 'LW': 0.2837209302325581, 'WP': 0.6837209302325581, 'PW': 0.6837209302325581, 'WT': 0.5953488372093023, 'TW': 0.5953488372093023, 'WA': 0.6883720930232559, 'AW': 0.6883720930232559, 'WV': 0.40930232558139534, 'VW': 0.40930232558139534, 'WG': 0.8558139534883721, 'GW': 0.8558139534883721, 'WI': 0.2837209302325581, 'IW': 0.2837209302325581, 'WF': 0.18604651162790697, 'FW': 0.18604651162790697, 'WY': 0.17209302325581396, 'YW': 0.17209302325581396, 'WC': 1.0, 'CW': 1.0, 'WH': 0.5348837209302325, 'HW': 0.5348837209302325, 'WQ': 0.6046511627906976, 'QW': 0.6046511627906976, 'WN': 0.8093023255813954, 'NW': 0.8093023255813954, 'WK': 0.5116279069767442, 'KW': 0.5116279069767442, 'WD': 0.8418604651162791, 'DW': 0.8418604651162791, 'WE': 0.7069767441860465, 'EW': 0.7069767441860465, 'WM': 0.3116279069767442, 'MW': 0.3116279069767442, 'RR': 0.0, 'LL': 0.0, 'PP': 0.0, 'TT': 0.0, 'AA': 0.0, 'VV': 0.0, 'GG': 0.0, 'II': 0.0, 'FF': 0.0, 'YY': 0.0, 'CC': 0.0, 'HH': 0.0, 'QQ': 0.0, 'NN': 0.0, 'KK': 0.0, 'DD': 0.0, 'EE': 0.0, 'MM': 0.0, 'WW': 0.0, 'SS': 0.0}
gram_temp_list = list()      #合并两个表的列表
gram_temp_list1=list()       # 存储表1每个氨基酸序列的结果
gram_temp_list2=list()       # 存储表2每个氨基酸序列的结果
num_temp_list = list()      # 两氨基酸距离的存储列表，
fr_list=list()              # 各氨基酸在序列中频率的存储列表，排列顺序为氨基酸序列的顺序
result_list =list()         # 最后得到的32维向量
acid_types = ['A', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'Y']

# 计算tao的函数，如tao3
# b指的是几级序列，也就是跨了b个，
# num是两个氨基酸的距离,
# data是读取文件的氨基酸序列
# flag是判断用表1的距离还是表2 的距离的标志
def Tao(b,data,flag):

    # 得到氨基酸与氨基酸之间的距离
    for i in range(0, len(data)-1):

        # 避免列表越界
        if (i + b) > (len(data)-1):
            break

        str1 = data[i]              # 获取第i个元素
        str2 = data[i+b]            #获取第i+b个元素
        str  = str1+str2            # 拼接两个元素

        #判断是用表1还是表2
        if flag == 1:
            D = D1
        if flag == 2:
            D = D2

        # 判断该字符串是否在D1表中，若在可取值，若不在则为o
        if str in D.keys():
            num_temp_list.append(D[str])
        else:
            num_temp_list.append(0)

    # 这个算出结果为tao_b
    t = 0                               # 最后结果tao
    m = 0                               # 遍历距离列表索引
    while (m < 25 - b):
        t += (1 / (25 - b)) * pow(num_temp_list[m], 2)
        m = m+1

    num_temp_list.clear()               # 清空该片段的距离
    return float(t)


# 计算u小于等于20的公式，
# data为氨基酸序列，
# sum_fr为各氨基酸频率之和，
# fr为第i个氨基酸频率
def Xr(fr,sum_fr,data,flag):

    # tao的序列和，从tao1加到tao12，最后作为Xr公式的部分分母
    t = 0
    for b in range(1,13):
        t += Tao(b,data,flag)

    # 列公式，得到结果
    x = fr/(sum_fr+0.1 * t)
    return float(x)


#计算u大于20的公式,
# i表示u中第几个特征，
# data为氨基酸序列，
# sum_fr为各氨基酸频率之和，
def Xd(sum_fr,i,data,flag):

    # tao的序列和，从tao1加到tao12，最后作为Xd公式的部分分母
    t = 0
    for b in range(1,13):
        t += Tao(b,data,flag)

    # 列公式，得到结果
    x = 0.1 * Tao((i-20),data,flag)/(sum_fr + 0.1 * t)
    return float(x)



#读取文件，获取氨基酸序列
with open(r"test.txt",'r') as f:
    while (f.readline()!= ''):
        data=f.readline().strip('\n')       # 去掉氨基酸序列行\n   GLSLNDRKKLLAKDLRGEMTLPATD

        # 获取各个氨基酸的频率
        for type in acid_types:             # 遍历每个氨基酸类型
            num = 0
            for d in data:                  # 遍历序列片段中每个氨基酸
                if (d == type):             # 判断是哪个氨基酸并记录个数
                    num += 1
            fr = num / 25                   # 计算fr
            fr_list.append(fr)

        # 计算氨基酸序列的频率和
        sum_fr = 0
        for i in range(0, 20):
            sum_fr += fr_list[i]

        # 每个氨基酸序列32次循环，得到32维特征向量
        u=1             # 控制循环次数，并知道该用哪个公式
        while(u<=32):
            # 前20个特征向量
            if(u<=20):
                flag = 1
                gram_temp_list1.append(Xr(fr_list[u-1],sum_fr,data,flag))    #fr_list是从0开始的
                flag = 2
                gram_temp_list2.append(Xr(fr_list[u-1],sum_fr,data,flag))    #fr_list是从0开始的

            # 后12个特征向量
            if (u > 20):
                flag = 1
                gram_temp_list1.append(Xd(sum_fr,u,data,flag))
                flag = 2
                gram_temp_list2.append(Xd(sum_fr,u,data,flag))
            u=u+1
        # 合并两个列表gram_temp_list1、gram_temp_list2
        gram_temp_list = gram_temp_list1 + gram_temp_list2
        result_list.append(list(gram_temp_list))
        gram_temp_list1.clear()
        gram_temp_list2.clear()
        fr_list.clear()
    print(result_list)
